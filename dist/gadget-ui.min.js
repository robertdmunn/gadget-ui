"use strict";var gadgetui={};gadgetui.model=function(){function a(a,b){this.data=a,this.elements=[],void 0!==b&&this.bind(b)}var b={};return a.prototype.change=function(a,b){var c,d;for(void 0===b?this.data=a:this.data[b]=a,d=0;d<this.elements.length;d++)c=this.elements[d],c.elem.value=0===c.prop.length?a:void 0!==b?a[b.prop]:a[c.elem.prop],d++},a.prototype.bind=function(a,b){var c;void 0===b?(a.value=this.data,c={elem:a,prop:""}):(a.value=this.data[b],c={elem:a,prop:b}),a[0].addEventListener("change",this,!1),this.elements.push(c)},{BindableObject:a,create:function(c,d,e){b[c]=void 0!==e?new a(d,e):new a(d)},destroy:function(a){delete b[a]},bind:function(a,c){var d=a.split(".");1===d.length?b[a].bind(c):b[d[0]].bind(c,d[1])},exists:function(a){return b.hasOwnProperty(a)?!0:!1},get:function(a){var c=a.split(".");try{if(1===c.length){if(void 0===b[a])throw"Key '"+a+"' does not exist in the model.";return b[a].data}if(void 0===b[c[0]])throw"Key '"+c[0]+"' does not exist in the model.";return b[c[0]].data[c[1]]}catch(d){return void console.log(d)}},set:function(a,c){var d=a.split(".");if(this.exists(d[0])===!1){if(1!==d.length)throw"Object "+d[0]+"is not yet initialized.";this.create(a,c)}else 1===d.length?b[a].change(c):b[d[0]].change(c,d[1])}}}(),gadgetui.input=function(a){function b(b){function c(b,c,d,e,f){var g,h=this;g=void 0===f?{}:f,a("span",a(b)).on("mouseenter",function(){h=this,a(a(h)).hide(),a(a(h).parent()).on("mouseleave",function(){var b=this;a("input",a(b)).is(":focus")===!1&&(a("span",a(b)).css("display","inline"),a("input",a(b)).hide())}),a("input",a(h).parent()).css("min-width","10em").css("width",Math.round(.66*a("input",a(h).parent()).val().length)+"em").css("display","inline").on("blur",function(){var b,f=this;setTimeout(function(){b=a(f).val(),g.isDirty===!0&&(0===b.length&&void 0!==a(f).attr("placeholder")&&(b=a(f).attr("placeholder")),g[f.name]=a(f).val(),a("span",a(f).parent()).text(b),void 0!==d&&void 0===a(f).attr("gadgetui-bind")&&d.set(f.name,g[f.name]),g.isDirty=!1,c===!0&&a(f).trigger("gadgetui-input-change",[g]),void 0!==e&&e(g)),a("span",a(f).parent()).css("display","inline"),a("img",a(f).parent()).hide(),a(f).hide()},200)}).on("keyup",function(b){var c=this;13===parseInt(b.keyCode,10)&&a(c).blur(),a(c).css("width",Math.round(.66*a("input",a(c).parent()).val().length)+"em")})}),a(b).on("change",function(b){var c=this,d=b.target.value;0===d.trim().length&&(d=" ... "),g.isDirty=!0,a("span",a(c).parent()).text(d)})}var d,e,f,g,h=this;return h.emitEvents=!0,h.model,h.func,el=void 0===b.el?a("input[gadgetui-textinput='true']",document):b.el,1===el.length&&void 0!==b.object&&(f=b.object),void 0!==b.config&&h.config(b.config),a.each(el,function(b,i){d=a(i).val(),e=a(i).attr("placeholder"),g=a(i).attr("gadgetui-bind"),void 0!==g&&void 0!==h.model&&h.model.bind(g,a(i)),0===d.length&&(d=void 0!==e&&e.length>0?e:" ... "),a(i).wrap("<div class='gadgetui-textinput-div'></div>"),a(i).parent().prepend("<span>"+d+"</span>"),a(i).hide(),c(a(i).parent(),h.emitEvents,h.model,h.func,f)}),this}function c(b){function c(b,c,d,e,f){var g,h=this;g=void 0===f?{}:f,a("span",a(b)).on("mouseenter",function(){h=this,a(a(h)).hide(),a(a(this).parent()).on("mouseleave",function(){a("select",a(this)).is(":focus")===!1&&a("input",a(this).parent().parent()).is(":focus")===!1&&(a("span",a(this)).css("display","inline"),a("select",a(this)).hide())}),a("select",a(h).parent()).css("min-width","10em").css("display","inline").on("blur",function(){var b,f=this;setTimeout(function(){b=a(f).val(),g.isDirty===!0&&(0===b.trim().length&&(b=" ... "),g[f.name]=a(f).val(),a("span",a(f).parent()).text(b),void 0!==d&&void 0===a(f).attr("gadgetui-bind")&&d.set(f.name,g[f.name]),g.isDirty=!1,c===!0&&a(f).trigger("gadgetui-input-change",[g]),void 0!==e&&e(g)),a("span",a(f).parent()).css("display","inline"),a(f).hide()},100)}).on("change",function(b){var c=this,d=b.target.value;0===d.trim().length&&(d=" ... "),g.isDirty=!0,a("span",a(c).parent()).text(d)}).on("keyup",function(b){var c=this;13===parseInt(b.keyCode,10)&&a(c).blur()})})}var d,e,f,g,h=this;return h.emitEvents=!0,h.model,h.func,el=void 0===b.el?a("select[gadgetui-selectinput='true']",document):b.el,1===el.length&&void 0!==b.object&&(f=b.object),void 0!==b.config&&h.config(b.config),a.each(el,function(b,i){d=a(i).val(),e=a(i).attr("placeholder"),g=a(i).attr("gadgetui-bind"),void 0!==g&&void 0!==h.model&&h.model.bind(g,a(i)),0===d.length&&(d=void 0!==e&&e.length>0?e:" ... "),a(i).wrap("<div class='gadgetui-selectinput-div'></div>"),a(i).parent().prepend("<span>"+d+"</span>"),a(i).hide(),c(a(i).parent(),h.emitEvents,h.model,h.func,f)}),this}return b.prototype.config=function(a){var b=this;b.model=void 0===a.model?b.model:a.model,b.func=void 0===a.func?void 0:a.func,b.emitEvents=void 0===a.emitEvents?!0:a.emitEvents},c.prototype.config=function(a){var b=this;b.model=void 0===a.model?b.model:a.model,b.func=void 0===a.func?void 0:a.func,b.emitEvents=void 0===a.emitEvents?!0:a.emitEvents},{TextInput:b,SelectInput:c}}(jQuery),gadgetui.util=function(){return{split:function(a){return a.split(/,\s*/)},extractLast:function(a){return this.split(a).pop()},getNumberValue:function(a){return Number(a.substring(0,a.length-2))},getRelativeParentOffset:function(a){var b,c=a.parentsUntil("body"),d=0,e=0;for(b=0;b<c.length;b++)"relative"===$(c[b]).css("position")&&($(c[b]).offset().left>d&&(d=$(c[b]).offset().left),$(c[b]).offset().top>e&&(e=$(c[b]).offset().top));return{left:d,top:e}},Id:function(){return(100*Math.random()).toString().replace(/\./g,"")},bind:function(a,b){var c=$(a).attr("gadgetui-bind");void 0!==c&&void 0!==b&&b.bind(c,$(a))},encode:function(a,b){var c,d=!0,e=!0,f="html";if(void 0!==b&&(d=void 0===b.canon?!0:b.canon,e=void 0===b.encode?!0:b.encode,f=void 0===b.encodeType?"html":b.encodeType),d&&(c=$.encoder.canonicalize(a)),e)switch(f){case"html":c=$.encoder.encodeForHTML(c);break;case"css":c=$.encoder.encodeForCSS(c);break;case"attr":c=$.encoder.encodeForHTMLAttribute(c);break;case"js":c=$.encoder.encodeForJavascript(c);break;case"url":c=$.encoder.encodeForURL(c)}return c},mouseCoords:function(a){return a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop-document.body.clientTop}},mouseWithin:function(a,b){var c=a[0].getBoundingClientRect();return b.x>=c.left&&b.x<=c.right&&b.y>=c.top&&b.y<=c.bottom?!0:!1},getStyle:function(a,b){return void 0!==window.getComputedStyle?void 0!==b?window.getComputedStyle(a,null).getPropertyValue(b):window.getComputedStyle(a,null):void 0!==b?a.currentStyle[b]:a.currentStyle}}}();