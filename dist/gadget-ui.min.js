"use strict";var gadgetui={};gadgetui.model=function(){function a(a,b){this.data=a,this.elements=[],void 0!==b&&this.bind(b)}var b={};return a.prototype.handleEvent=function(a){var b,c;switch(a.type){case"change":for(b=0;b<this.elements.length;b++)c=this.elements[b],a.target.name===c.prop&&"updateDomElement"!==a.originalSource&&(a.target.type.match(/select/)?this.change({value:a.target.value,key:a.target.options[a.target.selectedIndex].innerHTML},a,c.prop):this.change(a.target.value,a,c.prop))}},a.prototype.change=function(a,b,c){var d,e;if(void 0===c)this.data=a;else{if("object"!=typeof this.data)throw"Attempt to treat a simple value as an object with properties. Change fails.";if(void 0===this.data[c])throw"Property '"+c+"' of object is undefined.";this.data[c]=a}for(d=0;d<this.elements.length;d++)e=this.elements[d],void 0!==c&&c!==e.prop||void 0===b.target||e.elem==b.target||this.updateDomElement(b,e.elem,a)},a.prototype.updateDom=function(a,b,c){var d,e;for(d=0;d<this.elements.length;d++)e=this.elements[d],(void 0===c||void 0!==c&&e.prop===c)&&this.updateDomElement(a,e.elem,b)},a.prototype.updateDomElement=function(a,b,c){if("object"==typeof c?"DIV"===b.tagName?b.innerText=c.text:b.value=c.id:"DIV"===b.tagName?b.innerText=c:b.value=c,console.log("updated Dom element: "+b),"model.set"!==a.originalSource){var d=new Event("change");d.originalSource="updateDomElement",b.dispatchEvent(d)}},a.prototype.bind=function(a,b){var c,d=this;void 0===b?(a.value=this.data,c={elem:a,prop:""}):(a.value=this.data[b],c={elem:a,prop:b}),a.addEventListener?a.addEventListener("change",this,!1):a.attachEvent("onpropertychange",function(a){if("value"===a.propertyName){var b=a.srcElement,c="SELECT"===b.nodeName?{value:b.value,key:b.options[b.selectedIndex].innerHTML}:b.value;d.change(c,{target:b},b.name)}}),this.elements.push(c)},{BindableObject:a,create:function(c,d,e){b[c]=void 0!==e?new a(d,e):new a(d)},destroy:function(a){delete b[a]},bind:function(a,c){var d=a.split(".");1===d.length?b[a].bind(c):b[d[0]].bind(c,d[1])},exists:function(a){return b.hasOwnProperty(a)?!0:!1},get:function(a){var c=a.split(".");try{if(1===c.length){if(void 0===b[a])throw"Key '"+a+"' does not exist in the model.";return b[a].data}if(void 0===b[c[0]])throw"Key '"+c[0]+"' does not exist in the model.";return b[c[0]].data[c[1]]}catch(d){return void console.log(d)}},set:function(a,c){var d=a.split("."),e={originalSource:"model.set"};if(this.exists(d[0])===!1){if(1!==d.length)throw"Object "+d[0]+"is not yet initialized.";this.create(a,c)}else 1===d.length?(b[a].change(c,e),b[a].updateDom(e,c)):(b[d[0]].change(c,e,d[1]),b[d[0]].updateDom(e,c,d[1]));console.log("model value set: name: "+a+", value: "+c)}}}(),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d,e,f,g,h=Object(this),i=h.length,j=i>>>0;if("function"!=typeof a)throw new TypeError;for(c=b?b:void 0,d=0;j>d;)e=d.toString(),f=h.hasOwnProperty(e),f&&(g=h[e],a.call(c,g,d,h)),d+=1;return void 0}),gadgetui.display=function(){function a(a,b,c){this.selector=a,this.message=b,this.config(c),this.render(),this.setStyles(),this.setBehaviors(),this.show()}function b(a,b){this.selector=a,void 0!==b&&this.config(b),this.addControl(),this.addCSS(),this.addHeader(),this.icon=this.wrapper.querySelector("div.oi"),this.addBindings(),this.height=this.wrapper.offsetHeight,this.headerHeight=this.header.offsetHeight,this.selectorHeight=this.selector.offsetHeight,this.collapse===!0&&this.toggle()}function c(a,b){this.selector=a,void 0!==b&&this.config(b),this.addControl(),this.addHeader(),this.maxmin=this.wrapper.querySelector("div.oi"),this.addCSS(),this.height=gadgetui.util.getStyle(this.wrapper,"height"),this.relativeOffsetLeft=gadgetui.util.getRelativeParentOffset(this.selector).left,this.addBindings()}return a.prototype.render=function(){var a,b,c,d=document.createElement("div");gadgetui.util.addClass(d,"gadgetui-bubble"),gadgetui.util.addClass(d,"gadgetui-bubble-"+this.bubbleType),d.setAttribute("id",this.id),d.innerHTML=this.message,this.closable&&(a=document.createElement("span"),gadgetui.util.addClass(a,"oi"),a.setAttribute("data-glyph","circle-x")),b=document.createElement("div"),gadgetui.util.addClass(b,"gadgetui-bubble-arrow-outside"),this.selector.parentNode.insertBefore(d,this.selector.nextSibling),this.bubbleSelector=document.getElementById(this.id),this.closable&&this.bubbleSelector.appendChild(a),this.bubbleSelector.appendChild(b),c=document.createElement("div"),gadgetui.util.addClass(c,"gadgetui-bubble-arrow-inside"),this.bubbleSelector.appendChild(c)},a.prototype.show=function(){this.bubbleSelector.style.display="block"},a.prototype.setStyles=function(){this.setBubbleStyles(),this.calculateArrowPosition(),this.calculateArrowStyle(),this.setBeforeRules(),this.setAfterRules(),this.calculatePosition(),this.bubbleSelector.style.top=this.top+"px",this.bubbleSelector.style.left=this.left+"px",this.spanElement=this.bubbleSelector.getElementsByTagName("span");var a=this.bubbleWidth-6-this.closeIconSize-2*this.borderWidth;this.spanElement[0].setAttribute("style","left: "+a+"px; position: absolute; cursor: pointer; top: 6px; color: "+this.borderColor+";")},a.prototype.setBubbleStyles=function(){this.bubbleSelector.setAttribute("style","margin : 0; width:"+this.width+"px; height:"+this.height+"px; padding:"+this.padding+"px; line-height:"+this.lineHeight+"px; border-radius:"+this.borderRadius+"px; -moz-border-radius:"+this.borderRadius+"px; -webkit-border-radius:"+this.borderRadius+";-webkit-box-shadow: "+this.shadowSize+"px "+this.shadowSize+"px 4px "+this.boxShadowColor+"; -moz-box-shadow: "+this.shadowSize+"px "+this.shadowSize+"px 4px "+this.boxShadowColor+"; box-shadow:"+this.shadowSize+"px "+this.shadowSize+"px 4px "+this.boxShadowColor+"; border: "+this.borderWidth+"px solid "+this.borderColor+"; background-color: "+this.backgroundColor+"; position: absolute; text-align: left; opacity:"+this.opacity+"; font: "+this.font+"; z-index: "+this.zIndex+";")},a.prototype.setBeforeRules=function(){var a=this.bubbleSelector.getElementsByClassName("gadgetui-bubble-arrow-outside");a[0].setAttribute("style","content: ''; position: absolute; width: 0; height: 0; left: "+this.beforeArrowLeft+"px; top : "+this.arrowTop+"px; border: "+this.arrowSize+"px solid; border-color :"+this.beforeBorderColor+";")},a.prototype.setAfterRules=function(){var a=this.bubbleSelector.getElementsByClassName("gadgetui-bubble-arrow-inside");a[0].setAttribute("style","content: ''; position: absolute; width: 0; height: 0; left: "+this.afterArrowLeft+"px; top : "+this.afterArrowTop+"px; border: "+this.afterArrowSize+"px solid; border-color :"+this.afterBorderColor+";")},a.prototype.calculatePosition=function(){var a=this;this.relativeOffset=gadgetui.util.getRelativeParentOffset(this.selector),this.position.split(" ").forEach(function(b){switch(b){case"top":a.top=a.top-a.relativeOffset.top;break;case"bottom":a.top=a.top+a.selector.offsetHeight-a.relativeOffset.top;break;case"left":break;case"right":a.left=a.left+a.selector.offsetWidth-a.relativeOffset.left;break;case"center":a.left=a.left+a.selector.offsetWidth/2-a.relativeOffset.left}})},a.prototype.calculateArrowPosition=function(){var a,b=2*this.arrowSize,c=2*this.padding,d=this.borderWidth+this.borderRadius+this.arrowSize,e=Math.floor(Math.sqrt(Math.pow(this.borderWidth,2)+Math.pow(this.borderWidth,2)))-1;switch(this.afterArrowSize=this.arrowSize-e,a=(b-2*this.afterArrowSize)/2,this.arrowPositionArray[0]){case"left":this.beforeArrowLeft=-b,this.afterArrowLeft=2*-this.afterArrowSize,this.left=this.left+this.arrowSize-this.borderWidth;break;case"right":this.beforeArrowLeft=this.width+c,this.afterArrowLeft=this.beforeArrowLeft,this.left=this.left-this.bubbleWidth-this.arrowSize+this.borderWidth;break;case"top":this.arrowTop=-b,this.afterArrowTop=-(2*this.afterArrowSize),this.top=this.top+this.arrowSize-this.borderWidth;break;case"bottom":this.arrowTop=this.height+c,this.afterArrowTop=this.arrowTop,this.top=this.top-this.bubbleHeight-this.arrowSize+this.borderWidth}switch(this.arrowPositionArray[1]){case"top":this.arrowTop=this.borderRadius,this.afterArrowTop=this.arrowTop+a,this.top=this.top-d;break;case"bottom":this.arrowTop=this.bubbleHeight-2*this.borderWidth-b-this.borderRadius,this.afterArrowTop=this.arrowTop+a,this.top=this.top-this.bubbleHeight+d;break;case"right":this.beforeArrowLeft=this.bubbleWidth-2*this.borderWidth-b-this.borderRadius,this.afterArrowLeft=this.beforeArrowLeft+e,this.left=this.left-this.bubbleWidth+d;break;case"left":this.beforeArrowLeft=this.borderRadius,this.afterArrowLeft=this.beforeArrowLeft+e,this.left=this.left-d}},a.prototype.calculateArrowStyle=function(){var a=[],b=this.arrowPositionArray[0],c=this.arrowPositionArray[1]+" "+this.arrowDirection;if("middle"===this.arrowDirection)switch(this.arrowPositionArray[0]){case"top":this.beforeBorderColor="transparent transparent "+this.borderColor+" transparent",this.afterBorderColor="transparent transparent #fff transparent";break;case"bottom":this.beforeBorderColor=this.borderColor+" transparent transparent transparent",this.afterBorderColor="#fff transparent transparent transparent";break;case"right":this.beforeBorderColor="transparent transparent transparent "+this.borderColor,this.afterBorderColor="transparent transparent transparent #fff";break;case"left":this.beforeBorderColor="transparent "+this.borderColor+" transparent transparent",this.afterBorderColor="transparent #fff transparent transparent"}else"top"===b||"bottom corner"===c||"top center"===c?(a[0]="transparent",a[2]=this.borderColor):("bottom"===b||"bottom center"===c||"top corner"===c)&&(a[0]=this.borderColor,a[2]="transparent"),"right"===b||"left corner"===c||"right center"===c?(a[1]="transparent",a[3]=this.borderColor):("left"===b||"left center"===c||"right corner"===c)&&(a[1]=this.borderColor,a[3]="transparent"),this.beforeBorderColor=a.toString().replace(/\),/gi,") ").replace(/,transparent/gi," transparent").replace(/transparent,/gi,"transparent "),this.afterBorderColor=this.beforeBorderColor.replace(this.borderColor,"#fff","g")},a.prototype.setBehaviors=function(){var a=this;this.spanElement[0].addEventListener("click",function(){a.bubbleSelector.style.display="none",a.bubbleSelector.parentNode.removeChild(a.bubbleSelector)}),this.autoClose&&(closeBubble=function(){a.bubbleSelector.style.display="none",a.bubbleSelector.parentNode.removeChild(a.bubbleSelector)},setTimeout(closeBubble,this.autoCloseDelay))},a.prototype.config=function(a){var b="silver";this.bubbleType=void 0===a.bubbleType?"speech":a.bubbleType,this.id="gadgetui-bubble-"+gadgetui.util.Id(),this.height=void 0===a.height?100:a.height,this.position=void 0===a.position?"top right":a.position,this.width=void 0===a.width?200:a.width,this.padding=void 0===a.padding?20:a.padding,this.opacity=void 0===a.opacity?1:a.opacity,this.top=gadgetui.util.getOffset(this.selector).top,this.left=gadgetui.util.getOffset(this.selector).left,this.shadowColor=void 0===a.shadowColor?b:a.shadowColor,this.shadowSize=2,this.borderColor=void 0===a.borderColor?b:a.borderColor,this.borderWidth=void 0===a.borderWidth?8:a.borderWidth,this.arrowPosition=void 0===a.arrowPosition?"bottom left":a.arrowPosition,this.arrowDirection=void 0===a.arrowDirection?"middle":a.arrowDirection,this.arrowPositionArray=this.arrowPosition.split(" "),this.bubbleWidth=this.width+2*this.padding+2*this.borderWidth,this.bubbleHeight=this.height+2*this.padding+2*this.borderWidth,this.closeIconSize=13,this.arrowSize=void 0===a.arrowSize?25:a.arrowSize,this.backgroundColor=void 0===a.backgroundColor?"#FFFFFF":a.backgroundColor,this.lineHeight=void 0===a.lineHeight?"1.2em":a.lineHeight,this.borderRadius=void 0===a.borderRadius?30:a.borderRadius,this.boxShadowColor=void 0===a.boxShadowColor?b:a.boxShadowColor,this.font=void 0===a.font?"1em Arial sans":a.font,this.zIndex=void 0===a.zIndex?100:a.zIndex,this.closable=void 0===a.closable?!1:a.closable,this.autoClose=void 0===a.autoClose?!1:a.autoClose,this.autoCloseDelay=void 0===a.autoCloseDelay?5e3:a.autoCloseDelay,this.relativeOffset={left:0,top:0}},b.prototype.addControl=function(){var a=document.createElement("div");gadgetui.util.addClass(a,"gadget-ui-collapsiblePane"),this.selector.parentNode.insertBefore(a,this.selector),this.wrapper=this.selector.previousSibling,this.selector.parentNode.removeChild(this.selector),a.appendChild(this.selector)},b.prototype.addHeader=function(){var a,b=document.createElement("div");b.setAttribute("style","padding: 2px 0px 2px .5em; text-align: left; border-radius: "+this.borderRadius+"px; border: 1px solid "+this.borderColor+"; background: "+this.headerBackgroundColor+"; color: "+this.headerColor+"; font-weight: bold; font: "+this.font),gadgetui.util.addClass(b,"gadget-ui-collapsiblePane-header"),b.innerHTML=this.title,this.wrapper.insertBefore(b,this.selector),this.header=this.wrapper.querySelector("div.gadget-ui-collapsiblePane-header"),a=document.createElement("div"),gadgetui.util.addClass(a,"oi"),a.setAttribute("data-glyph","caret-top"),this.header.appendChild(a)},b.prototype.addCSS=function(){var a=this.width;this.wrapper.setAttribute("style","width: "+a+"; border: 1px solid "+this.borderColor+"; border-radius: "+this.borderRadius+"px; overflow: hidden;"),this.selector.style||this.selector.setAttribute("style","padding: "+this.padding+"px;")},b.prototype.addBindings=function(){var a=this,b=this.wrapper.querySelector("div.gadget-ui-collapsiblePane-header");b.addEventListener("click",function(){a.toggle()})},b.prototype.config=function(a){this.title=void 0===a.title?"":a.title,this.path=void 0===a.path?"/bower_components/gadget-ui/dist/":a.path,this.padding=void 0===a.padding?".5em":a.padding,this.paddingTop=void 0===a.paddingTop?".3em":a.paddingTop,this.width=void 0===a.width?gadgetui.util.getStyle(this.selector,"width"):a.width,this.interiorWidth=void 0===a.interiorWidth?"":a.interiorWidth,this.collapse=void 0===a.collapse||a.collapse===!1?!1:!0,this.borderColor=void 0===a.borderColor?"silver":a.borderColor,this.headerColor=void 0===a.headerColor?"black":a.headerColor,this.headerBackgroundColor=void 0===a.headerBackgroundColor?"silver":a.headerBackgroundColor,this.borderRadius=void 0===a.borderRadius?6:a.borderRadius},b.prototype.toggle=function(){var a,b,c,d,e,f=this,g="caret-bottom",h="caret-top";this.collapsed===!0?(a=h,c="block",b=this.height,e=this.selectorHeight,d="1px solid "+this.borderColor,this.collapsed=!1):(a=g,c="none",b=this.headerHeight,e=0,d="1px solid transparent",this.collapsed=!0),f.eventName="collapse"===f.eventName?"expand":"collapse",f.selector.style.padding=f.padding+"px",f.selector.style.paddingTop=f.paddingTop+"px";var i=new Event(f.eventName);f.selector.dispatchEvent(i),"undefined"!=typeof Velocity?("block"===c&&(f.wrapper.style.border=d),Velocity(this.wrapper,{height:b},{queue:!1,duration:500,complete:function(){f.icon.setAttribute("data-glyph",a)}}),Velocity(this.selector,{height:e},{queue:!1,duration:500,complete:function(){}})):(f.selector.style.display=c,f.icon.setAttribute("data-glyph",a))},c.prototype.addBindings=function(){var a=this;gadgetui.util.draggable(this.wrapper),this.maxmin.addEventListener("click",function(){a.minimized?a.expand():a.minimize()})},c.prototype.addHeader=function(){this.header=document.createElement("div"),this.header.innerHTML=this.title,gadgetui.util.addClass(this.header,"gadget-ui-floatingPane-header"),this.header.setAttribute("style","padding: 2px 0px 2px .5em; text-align: left; border-radius: "+this.borderRadius+"px; border: 1px solid "+this.borderColor+"; background: "+this.headerBackgroundColor+"; color: "+this.headerColor+"; font-weight: bold; font: "+this.font),this.icon=document.createElement("div"),gadgetui.util.addClass(this.icon,"oi"),this.header.insertBefore(this.icon,void 0),this.wrapper.insertBefore(this.header,this.selector),this.icon.setAttribute("data-glyph","fullscreen-exit"),this.header.appendChild(this.icon)},c.prototype.addCSS=function(){this.wrapper.setAttribute("style","width: "+this.width+"; border: 1px solid "+this.borderColor+"; border-radius: "+this.borderRadius+"px;"),this.wrapper.style.minWidth=this.minWidth,this.wrapper.style.opacity=this.opacity,this.wrapper.style.zIndex=this.zIndex,this.selector.setAttribute("style","width: "+this.interiorWidth+"px; padding: "+this.padding+"px;"),this.maxmin.setAttribute("style","float: right; display: inline;")},c.prototype.addControl=function(){var a=document.createElement("div");gadgetui.util.addClass(a,"gadget-ui-floatingPane"),this.selector.parentNode.insertBefore(a,this.selector),this.wrapper=this.selector.previousSibling,this.selector.parentNode.removeChild(this.selector),a.appendChild(this.selector)},c.prototype.config=function(a){this.title=void 0===a.title?"":a.title,this.path=void 0===a.path?"/bower_components/gadget-ui/dist/":a.path,this.position=void 0===a.position?{my:"right top",at:"right top",of:window}:a.position,this.padding=void 0===a.padding?"15px":a.padding,this.paddingTop=void 0===a.paddingTop?".3em":a.paddingTop,this.width=void 0===a.width?gadgetui.util.getStyle(this.selector,"width"):a.width,this.minWidth=this.title.length>0?Math.max(100,10*this.title.length)+20:100,this.height=void 0===a.height?gadgetui.util.getNumberValue(gadgetui.util.getStyle(this.selector,"height"))+2*gadgetui.util.getNumberValue(this.padding):a.height,this.interiorWidth=void 0===a.interiorWidth?"":a.interiorWidth,this.opacity=void 0===a.opacity?1:a.opacity,this.zIndex=void 0===a.zIndex?1e5:a.zIndex,this.minimized=!1,this.relativeOffsetLeft=0,this.borderColor=void 0===a.borderColor?"silver":a.borderColor,this.headerColor=void 0===a.headerColor?"black":a.headerColor,this.headerBackgroundColor=void 0===a.headerBackgroundColor?"silver":a.headerBackgroundColor,this.borderRadius=void 0===a.borderRadius?6:a.borderRadius},c.prototype.expand=function(){var a=this,b=gadgetui.util.getOffset(this.wrapper),c=parseInt(new Number(b.left),10)-this.relativeOffsetLeft,d=parseInt(this.width.substr(0,this.width.length-2),10);"undefined"!=typeof Velocity?(Velocity(this.wrapper,{left:c-d+a.minWidth},{queue:!1,duration:500},function(){}),Velocity(this.wrapper,{width:this.width},{queue:!1,duration:500},function(){}),Velocity(this.wrapper,{height:this.height},{queue:!1,duration:500,complete:function(){a.icon.setAttribute("data-glyph","fullscreen-exit")}})):(this.wrapper.style.left=c-d+this.minWidth+"px",this.wrapper.style.width=this.width,this.wrapper.style.height=this.height,this.icon.setAttribute("data-glyph","fullscreen-exit")),this.minimized=!1},c.prototype.minimize=function(){var a=this,b=gadgetui.util.getOffset(this.wrapper),c=parseInt(new Number(b.left),10)-this.relativeOffsetLeft,d=parseInt(this.width.substr(0,this.width.length-2),10);"undefined"!=typeof Velocity?(Velocity(this.wrapper,{left:c+d-a.minWidth},{queue:!1,duration:500},function(){}),Velocity(this.wrapper,{width:a.minWidth},{queue:!1,duration:500,complete:function(){a.icon.setAttribute("data-glyph","fullscreen-enter")}}),Velocity(this.wrapper,{height:"50px"},{queue:!1,duration:500},function(){})):(this.wrapper.style.left=c+d-this.minWidth+"px",this.wrapper.style.width=this.minWidth+"px",this.wrapper.style.height="50px",this.icon.setAttribute("data-glyph","fullscreen-enter")),this.minimized=!0},{Bubble:a,CollapsiblePane:b,FloatingPane:c}}(),gadgetui.input=function(){function a(a,b){this.selector=a,this.config(b),this.setInitialValue(),gadgetui.util.bind(this.selector,this.model),this.addControl(),this.addCSS(),this.selector.style.display="none",this.addBindings()}function b(a,b){this.emitEvents=!0,this.model=gadgetui.model,this.func,this.selector=a,void 0!==b&&this.config(b),gadgetui.util.bind(this.selector,this.model),this.setInitialValue(),this.addControl(),this.setLineHeight(),this.setFont(),this.setMaxWidth(),this.setWidth(),this.addCSS(),this.addBindings()}return a.prototype.setInitialValue=function(){this.selector.value=this.value.id},a.prototype.addControl=function(){this.wrapper=document.createElement("div"),this.label=document.createElement("div"),gadgetui.util.addClass(this.wrapper,"gadgetui-selectinput-div"),gadgetui.util.addClass(this.label,"gadgetui-selectinput-label"),this.label.innerHTML=this.value.text,this.selector.parentNode.insertBefore(this.wrapper,this.selector),this.wrapper=this.selector.previousSibling,this.selector.parentNode.removeChild(this.selector),this.wrapper.appendChild(this.selector),this.selector.parentNode.insertBefore(this.label,this.selector)},a.prototype.addCSS=function(){var a,b,c=gadgetui.util.getStyle(this.selector);this.selector.style.minWidth="100px",this.selector.style.fontSize=c.fontSize,b=gadgetui.util.getStyle(this.selector.parentNode),a=gadgetui.util.getNumberValue(b.height)-2,this.label.setAttribute("style",""),this.label.style.paddingTop="2px",this.label.style.height=a+"px",this.label.style.marginLeft="9px",navigator.userAgent.match(/Edge/)?this.selector.style.marginLeft="5px":navigator.userAgent.match(/MSIE/)&&(this.selector.style.marginTop="0px",this.selector.style.marginLeft="5px")},a.prototype.addBindings=function(){var a=this;this.label.addEventListener(this.activate,function(b){a.label.style.display="none",a.selector.style.display="inline-block",b.preventDefault()}),this.selector.addEventListener("blur",function(){var b,c;setTimeout(function(){b=a.selector.value,c=a.selector[a.selector.selectedIndex].innerHTML,0===b.trim().length&&(b=" ... "),a.label.innerText=c,void 0!==a.model&&void 0===a.selector.getAttribute("gadgetui-bind")&&a.model.set(this.name,{id:b,text:c}),a.emitEvents===!0&&a.selector.dispatchEvent(new Event("gadgetui-input-change"),{id:b,text:c}),void 0!==a.func&&a.func({id:b,text:c}),a.value={id:b,text:c},a.label.style.display="inline-block",a.selector.style.display="none"},100)}),this.wrapper.addEventListener("mouseleave",function(){a.selector!==document.activeElement&&(a.label.style.display="inline-block",a.selector.style.display="none")}),this.selector.addEventListener("change",function(b){var c=b.target.value,d=b.target[b.target.selectedIndex].innerHTML;0===d.trim().length&&(d=" ... "),a.label.innerText=d,a.value={id:c,text:d}})},a.prototype.config=function(a){this.model=void 0===a.model?void 0:a.model,this.func=void 0===a.func?void 0:a.func,this.emitEvents=void 0===a.emitEvents?!0:a.emitEvents,this.activate=void 0===a.activate?"mouseenter":a.activate,this.value=void 0===a.value?{id:this.selector[this.selector.selectedIndex].value,text:this.selector[this.selector.selectedIndex].innerHTML}:a.value},b.prototype.addControl=function(){this.wrapper=document.createElement("div"),this.labelDiv=document.createElement("div"),this.inputDiv=document.createElement("div"),this.label=document.createElement("input"),this.label.setAttribute("type","text"),this.label.setAttribute("data-active","false"),this.label.setAttribute("readonly","true"),this.label.setAttribute("value",this.value),this.labelDiv.appendChild(this.label),this.selector.parentNode.insertBefore(this.wrapper,this.selector),this.selector.parentNode.removeChild(this.selector),this.inputDiv.appendChild(this.selector),this.wrapper.appendChild(this.inputDiv),this.selector.parentNode.parentNode.insertBefore(this.labelDiv,this.inputDiv),this.wrapper=this.selector.parentNode.parentNode,this.labelDiv=this.wrapper.childNodes[0],this.label=this.labelDiv.childNodes[0],this.inputDiv=this.wrapper.childNodes[1]},b.prototype.setInitialValue=function(){var a=this.selector.value,b=this.selector.getAttribute("placeholder");0===a.length&&(a=null!==b&&void 0!==b&&b.length>0?b:" ... "),this.value=a},b.prototype.setLineHeight=function(){var a=this.selector.offsetHeight;this.lineHeight=a},b.prototype.setFont=function(){var a=gadgetui.util.getStyle(this.selector),b=a.fontFamily+" "+a.fontSize+" "+a.fontWeight+" "+a.fontVariant;this.font=b},b.prototype.setWidth=function(){var a=gadgetui.util.getStyle(this.selector);this.width=gadgetui.util.textWidth(this.selector.value,a)+10,10===this.width&&(this.width=this.minWidth)},b.prototype.setMaxWidth=function(){var a=gadgetui.util.getStyle(this.selector.parentNode.parentNode);this.maxWidth=gadgetui.util.getNumberValue(a.width)},b.prototype.addCSS=function(){var a=gadgetui.util.getStyle(this.selector);gadgetui.util.addClass(this.selector,"gadgetui-textinput"),gadgetui.util.addClass(this.wrapper,"gadgetui-textinput-div"),gadgetui.util.addClass(this.labelDiv,"gadgetui-inputlabel"),gadgetui.util.addClass(this.label,"gadgetui-inputlabelinput"),gadgetui.util.addClass(this.inputDiv,"gadgetui-inputdiv"),this.label.setAttribute("style","background:none; padding-left: 4px; border: 1px solid transparent; width: "+this.width+"px; font-family: "+a.fontFamily+"; font-size: "+a.fontSize+"; font-weight: "+a.fontWeight+"; font-variant: "+a.fontVariant),this.label.style.maxWidth="",this.label.style.minWidth=this.minWidth+"px",this.lineHeight>20&&(this.wrapper.setAttribute("style","min-height: "+this.lineHeight+"px;"),this.labelDiv.setAttribute("style","min-height: "+this.lineHeight+"px;"),this.inputDiv.setAttribute("style","min-height: "+this.lineHeight+"px;")),this.labelDiv.setAttribute("style","height: "+this.lineHeight+"px; font-size: "+a.fontSize+"; display: block"),this.inputDiv.setAttribute("style","height: "+this.lineHeight+"px; font-size: "+a.fontSize+"; display: block"),void 0===this.selector.getAttribute("style")&&this.selector.setAttribute("style",""),this.selector.style.paddingLeft="4px",this.selector.style.border="1px solid "+this.borderColor,this.selector.style.fontFamily=a.fontFamily,this.selector.style.fontSize=a.fontSize,this.selector.style.fontWeight=a.fontWeight,this.selector.style.fontVariant=a.fontVariant,this.selector.style.width=this.width+"px",this.selector.style.minWidth=this.minWidth+"px",this.selector.setAttribute("placeholder",this.value),this.inputDiv.style.display="none",this.maxWidth>10&&this.enforceMaxWidth===!0&&(this.label.style.maxWidth=this.maxWidth,this.selector.style.maxWidth=this.maxWidth,this.maxWidth<this.width&&(this.label.value=gadgetui.util.fitText(this.value,this.font,this.maxWidth)))},b.prototype.setControlWidth=function(a){var b=gadgetui.util.getStyle(this.selector),c=parseInt(gadgetui.util.textWidth(a,b),10);c<this.minWidth&&(c=this.minWidth),this.selector.style.width=c+30+"px",this.label.style.width=c+30+"px"},b.prototype.addBindings=function(){var a,b=this,a=void 0===this.object?{}:this.object;void 0===gadgetui.mousePosition&&document.addEventListener("mousemove",function(a){a=a||window.event,gadgetui.mousePosition=gadgetui.util.mouseCoords(a)}),this.selector.addEventListener("mouseleave",function(){this!==document.activeElement&&(b.labelDiv.style.display="block",b.inputDiv.style.display="none",b.label.style.maxWidth=b.maxWidth)}),this.selector.addEventListener("focus",function(a){a.preventDefault()}),this.selector.addEventListener("blur",function(){var c,d,e;setTimeout(function(){if(c=b.selector.value,a.isDirty===!0){0===c.length&&void 0!==b.selector.getAttribute("placeholder")&&(c=b.selector.getAttribute("placeholder")),a[b.selector.name]=b.selector.value;var f=gadgetui.util.getStyle(b.selector);d=gadgetui.util.textWidth(c,f),e=b.maxWidth<d?gadgetui.util.fitText(c,b.font,b.maxWidth):c,b.label.value=e,void 0!==b.model&&void 0===b.selector.getAttribute("gadgetui-bind")&&b.model.set(b.selector.name,a[b.selector.name]),a.isDirty=!1,b.emitEvents===!0&&b.selector.dispatchEvent("gadgetui-input-change",[a]),void 0!==b.func&&b.func(a)}b.inputDiv.style.display="none",b.labelDiv.style.display="block",b.label.setAttribute("data-active","false"),b.selector.style.maxWidth=b.maxWidth,b.label.style.maxWidth=b.maxWidth,b.emitEvents===!0&&b.selector.dispatchEvent(new Event("gadgetui-input-hide"),b.selector)},200)}),this.selector.addEventListener("keyup",function(a){13===parseInt(a.keyCode,10)&&this.blur(),b.setControlWidth(this.value)}),this.selector.addEventListener("change",function(c){var d=c.target.value;0===d.trim().length&&(d=" ... "),a.isDirty=!0,b.label.value=d}),this.label.addEventListener(b.activate,function(){!b.useActive||"false"!==b.label.getAttribute("data-active")&&void 0!==b.label.getAttribute("data-active")?setTimeout(function(){var a;gadgetui.util.mouseWithin(b.label,gadgetui.mousePosition)===!0&&(b.labelDiv.style.display="none",b.inputDiv.style.display="block",b.setControlWidth(b.selector.value),"click"===b.activate&&b.selector.focus(),b.emitEvents===!0&&(a=new Event("gadgetui-input-show"),b.selector.dispatchEvent(a,b.selector)))},b.delay):b.label.setAttribute("data-active","true")})},b.prototype.config=function(a){this.borderColor=void 0===a.borderColor?"#d0d0d0":a.borderColor,this.useActive=void 0===a.useActive?!1:a.useActive,this.model=void 0===a.model?this.model:a.model,this.object=void 0===a.object?void 0:a.object,this.func=void 0===a.func?void 0:a.func,this.emitEvents=void 0===a.emitEvents?!0:a.emitEvents,this.activate=void 0===a.activate?"mouseenter":a.activate,this.delay=void 0===a.delay?10:a.delay,this.minWidth=void 0===a.minWidth?100:a.minWidth,this.enforceMaxWidth=void 0===a.enforceMaxWidth?!1:a.enforceMaxWidth},{TextInput:b,SelectInput:a}}(),gadgetui.util=function(){return{split:function(a){return a.split(/,\s*/)},extractLast:function(a){return this.split(a).pop()},getNumberValue:function(a){return Number(a.substring(0,a.length-2))},addClass:function(a,b){a.classList?a.classList.add(b):a.className+=" "+b},getOffset:function(a){var b=a.getBoundingClientRect();return{top:b.top+document.body.scrollTop,left:b.left+document.body.scrollLeft}},getParentsUntil:function(a,b,c){var d=[];if(b)var e=b.charAt(0);if(c)var f=c.charAt(0);for(;a&&a!==document;a=a.parentNode){if(b){if("."===e&&a.classList.contains(b.substr(1)))break;if("#"===e&&a.id===b.substr(1))break;if("["===e&&a.hasAttribute(b.substr(1,b.length-1)))break;if(a.tagName.toLowerCase()===b)break}c?("."===f&&a.classList.contains(c.substr(1))&&d.push(a),"#"===f&&a.id===c.substr(1)&&d.push(a),"["===f&&a.hasAttribute(c.substr(1,c.length-1))&&d.push(a),a.tagName.toLowerCase()===c&&d.push(a)):d.push(a)}return 0===d.length?null:d},getRelativeParentOffset:function(a){var b,c,d=gadgetui.util.getParentsUntil(a,"body"),e=0,f=0;for(b=0;b<d.length;b++)"relative"===d[b].style.position&&(c=gadgetui.util.getOffset(d[b]),c.left>e&&(e=c.left),c.top>f&&(f=c.top));return{left:e,top:f}},Id:function(){return(100*Math.random()).toString().replace(/\./g,"")},bind:function(a,b){var c=a.getAttribute("gadgetui-bind");void 0!==c&&void 0!==b&&b.bind(c,a)},mouseCoords:function(a){return a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop-document.body.clientTop}},mouseWithin:function(a,b){var c=a.getBoundingClientRect();return b.x>=c.left&&b.x<=c.right&&b.y>=c.top&&b.y<=c.bottom?!0:!1},getStyle:function(a,b){return void 0!==window.getComputedStyle?void 0!==b?window.getComputedStyle(a,null).getPropertyValue(b):window.getComputedStyle(a,null):void 0!==b?a.currentStyle[b]:a.currentStyle},draggable:function(a){function b(a){e=a,h=f-e.offsetLeft,i=g-e.offsetTop}function c(a){f=document.all?window.event.clientX:a.pageX,g=document.all?window.event.clientY:a.pageY,null!==e&&(e.style.left=f-h+"px",e.style.top=g-i+"px")}function d(){e=null}var e=null,f=0,g=0,h=0,i=0;a.onmousedown=function(){return b(this),!1},document.onmousemove=c,document.onmouseup=d},textWidth:function(a,b){gadgetui.util.textWidthEl||(gadgetui.util.textWidthEl=document.createElement("div"),gadgetui.util.textWidthEl.setAttribute("id","gadgetui-textWidth"),gadgetui.util.textWidthEl.setAttribute("style","display: none;"),document.body.appendChild(gadgetui.util.textWidthEl));var c,d=a;return d.length>0&&(gadgetui.util.textWidthEl.innerText=d,d=void 0===d?"":d.replace(/\s/g,"&nbsp;")),gadgetui.util.textWidthEl.innertText=d,gadgetui.util.textWidthEl.style.fontFamily=b.fontFamily,gadgetui.util.textWidthEl.style.fontSize=b.fontSize,gadgetui.util.textWidthEl.style.fontWeight=b.fontWeight,gadgetui.util.textWidthEl.style.fontVariant=b.fontVariant,gadgetui.util.textWidthEl.style.display="inline",c=gadgetui.util.textWidthEl.offsetWidth,gadgetui.util.textWidthEl.style.display="none",c
},fitText:function(a,b,c){var d,e=gadgetui.util.TextWidth(a,b),f=gadgetui.util.TextWidth("...",b);if(c>e)return a;for(d=Math.floor(a.length/2)-1;e+f>=c;)a=a.slice(0,d)+a.slice(d+1,a.length),d=Math.floor(a.length/2)-1,e=gadgetui.util.TextWidth(a,font);for(d=Math.floor(a.length/2)-1,a=a.slice(0,d)+"..."+a.slice(d,a.length);" "===a.substring(d-1,d);)a=a.slice(0,d-1)+a.slice(d,a.length),d-=1;for(;" "===a.substring(d+3,d+4);)a=a.slice(0,d+3)+a.slice(d+4,a.length),d-=1;return a}}}();